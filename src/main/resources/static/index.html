<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Gemini Fashion Styler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin: 24px; }
    .wrap { max-width: 900px; margin: auto; }
    .row { display: flex; gap: 24px; flex-wrap: wrap; }
    img { max-width: 100%; border-radius: 8px; }
    button { padding: 10px 16px; font-size: 16px; }
    .loading { margin-top: 12px; }
  </style>
</head>
<body>
<div class="wrap">
  <h1>Gemini Fashion Styler</h1>

  <input type="file" id="img" accept="image/*" /><br/><br/>

  <input id="occasion" placeholder="Occasion (e.g. work, date)" /><br/><br/>
  <input id="vibe" placeholder="Vibe (e.g. minimalist, bold)" /><br/><br/>
  <input id="notes" placeholder="Notes (optional)" /><br/><br/>

  <button onclick="run()">Analyze</button>

  <div id="status" class="loading"></div>

  <h2>Observations</h2>
  <p id="obs"></p>

  <h2>Quick Fixes</h2>
  <ul id="fixes"></ul>

  <h2>Generated Result</h2>
  <img id="out" />
</div>

<script>
async function run() {
  const file = document.getElementById("img").files[0];
  if (!file) return alert("Please upload an image.");

  const fd = new FormData();
  fd.append("image", file);
  fd.append("occasion", occasion.value);
  fd.append("vibe", vibe.value);
  fd.append("notes", notes.value);

  status.textContent = "Analyzing outfit and generating styling ideasâ€¦";
  fixes.innerHTML = "";
  out.src = "";

  const res = await fetch("/api/fashion/style", { method: "POST", body: fd });
  const data = await res.json();

  status.textContent = "";

  obs.textContent =
    data.observations ||
    "We analyzed the outfit, but some details were unclear. Try a clearer photo or add notes.";

  (data.quickFixes || []).slice(0, 6).forEach(f => {
    const li = document.createElement("li");
    li.textContent = f;
    fixes.appendChild(li);
  });

  if (data.base64) {
    out.src = `data:${data.mimeType};base64,${data.base64}`;
  }
}
</script>
</body>
</html>

